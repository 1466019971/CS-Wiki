# 📊 五大数据类型

---

Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作**数据库**、**缓存**和**消息中间件MQ**。 它支持多种类型的数据结构，如 字符串（strings）， 散列（hashes）， 列表（lists）， 集合（sets）， 有序集合（sorted sets） 与范围查询， bitmaps， hyperloglogs 和 地理空间（geospatial） 索引半径查询。 Redis 内置了 复制（replication），LUA脚本（Lua scripting）， LRU驱动事件（LRU eviction），事务（transactions） 和不同级别的 磁盘持久化（persistence）， 并通过Redis哨兵（Sentinel）和自动 分区（Cluster）提供高可用性（high availability）。

## 1. Redis-Key

```powershell
127.0.0.1:6379 > select 1 # 选择 1 号数据库

127.0.0.1:6379[1]> keys * # 查看所有的key
(empty list or set)
127.0.0.1:6379[1]> set name smallbeef # set key
OK
127.0.0.1:6379[1]> keys *
1) "name"
127.0.0.1:6379[1]> set age 1
OK
127.0.0.1:6379[1]> keys *
1) "age"
2) "name"

127.0.0.1:6379[1]> EXISTS name # 判断当前的key是否存在
(integer) 1
127.0.0.1:6379[1]> EXISTS name1
(integer) 0

127.0.0.1:6379[1]> move name 2 # 移除当前的key
(integer) 1
127.0.0.1:6379[1]> keys *
1) "age"

127.0.0.1:6379[1]> set name yjc
OK
127.0.0.1:6379[1]> keys *
1) "age"
2) "name"
```

可以通过 clear 清空屏幕：

```powershell
127.0.0.1:6379> clear
```



```powershell
127.0.0.1:6379> keys *
1) "age"
2) "name"
127.0.0.1:6379> get name
"yjc"
127.0.0.1:6379> EXPIRE name 10 # 设置key的过期时间，单位是秒
(integer) 1
127.0.0.1:6379> ttl name # 查看当前key的剩余时间
(integer) 4
127.0.0.1:6379> ttl name
(integer) -2
127.0.0.1:6379> get name
(nil)
127.0.0.1:6379> type name # 查看当前key的一个类型！
none
127.0.0.1:6379> type age
string
```

##  2.  String 字符串

> 😳 90% 的 Java 程序员使用 Redis 只会使用一个 String 类型

✍ **命令 `set`、`get`、`APPEND`、`STRLEN` 示例**：

```powershell
127.0.0.1:6379> set key1 v1 # 设置值
OK
127.0.0.1:6379> get key1 # 获得值
"v1"
127.0.0.1:6379> keys * # 获得所有的key
1) "key1"
127.0.0.1:6379> EXISTS key1 # 判断某一个key是否存在
(integer) 1
127.0.0.1:6379> APPEND key1 "hello" # 追加字符串，如果当前key不存在，就相当于set key
(integer) 7
127.0.0.1:6379> get key1
"v1hello"
127.0.0.1:6379> STRLEN key1 # 获取字符串的长度！
(integer) 7
127.0.0.1:6379> APPEND key1 ",smallbeef"
(integer) 17
127.0.0.1:6379> STRLEN key1
(integer) 17
127.0.0.1:6379> get key1
"v1hello,smallbeef"
```

✍ **命令 `incr`、`decr` 、`INCRBY`，`DECRBY`示例**：

```powershell
127.0.0.1:6379> set views 0 # 初始浏览量为0
OK
127.0.0.1:6379> get views
"0"
127.0.0.1:6379> incr views # 自增1 浏览量变为1
(integer) 1
127.0.0.1:6379> incr views
(integer) 2
127.0.0.1:6379> get views
"2"
127.0.0.1:6379> decr views # 自减1 浏览量-1
(integer) 1
127.0.0.1:6379> decr views
(integer) 0
127.0.0.1:6379> decr views
(integer) -1
127.0.0.1:6379> get views
"-1"
127.0.0.1:6379> INCRBY views 10 # 可以设置步长，指定增量！
(integer) 9
127.0.0.1:6379> INCRBY views 10
(integer) 19
127.0.0.1:6379> DECRBY views 5
(integer) 14
```

✍ **命令 `GETRANGE`、`SETRANGE`  示例**：

```powershell
# 字符串范围 range
127.0.0.1:6379> set key1 "hello,smallbeef" # 设置 key1 的值
OK
127.0.0.1:6379> get key1
"hello,smallbeef"
127.0.0.1:6379> GETRANGE key1 0 3 # 截取字符串 [0,3]
"hell"
127.0.0.1:6379> GETRANGE key1 0 -1 # 获取全部的字符串(从0开始，到倒数第1个) 和 get key是一样的
"hello,kuangshen"

# 替换
127.0.0.1:6379> set key2 abcdefg
OK
127.0.0.1:6379> get key2
"abcdefg"
127.0.0.1:6379> SETRANGE key2 1 QR # 替换从指定位置 1 开始的字符串！
(integer) 7
127.0.0.1:6379> get key2
"aQRdefg"
```

✍ **命令 `setex`、`setnx`  示例**：

```powershell
# setex (set with expire) # 设置过期时间
# setnx (set if not exist) # 不存在在设置 （在分布式锁中会常常使用）

127.0.0.1:6379> setex key3 30 "hello" # 设置key3 的值为 hello,30秒后过期
OK
127.0.0.1:6379> ttl key3
(integer) 26

127.0.0.1:6379> setnx mykey "redis" # 如果mykey 不存在，创建mykey
(integer) 1

127.0.0.1:6379> keys *
1) "key2"
2) "mykey"
3) "key1"

127.0.0.1:6379> setnx mykey "MongoDB" # 如果mykey存在，创建失败
(integer) 0
127.0.0.1:6379> get mykey
"redis"
```

✍ **命令 `mset`、`mget`，`msetnx` 示例**：

```powershell
# mset
# mget

127.0.0.1:6379> mset k1 v1 k2 v2 k3 v3 # 同时设置多个值
OK
127.0.0.1:6379> keys *
1) "k1"
2) "k2"
3) "k3"

127.0.0.1:6379> mget k1 k2 k3 # 同时获取多个值
1) "v1"
2) "v2"
3) "v3"

127.0.0.1:6379> msetnx k1 v1 k4 v4 # msetnx 是一个原子性的操作，要么一起成功，要么一起失败
(integer) 0
127.0.0.1:6379> get k4
(nil)

# 对象
set user:1 {name:zhangsan,age:3} # 设置一个user:1 对象 值为 json字符来保存一个对象！
# 这里的key是一个巧妙的设计： user:{id}:{filed} , 如此设计在Redis中是完全OK了！

127.0.0.1:6379> mset user:1:name zhangsan user:1:age 2
OK
127.0.0.1:6379> mget user:1:name user:1:age
1) "zhangsan"
2) "2"
```

✍ **命令 `getset`  示例**：

```powershell
# getset 先get然后在set

127.0.0.1:6379> getset db redis # 如果不存在值，则返回 nil
(nil)
127.0.0.1:6379> get db
"redis"

127.0.0.1:6379> getset db mongodb # 如果存在值，获取原来的值，并设置新的值
"redis"
127.0.0.1:6379> get db
"mongodb"

```

## 3. List 列表

## 4. Set 集合

## 5. Hash 哈希

## 6. Zset 有序集合

## 📚 References

- [【狂神说Java】Redis最新超详细版教程通俗易懂](https://www.bilibili.com/video/BV1S54y1R7SB?from=search&seid=3325634079268895938)

