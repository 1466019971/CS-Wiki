# 🚪 一、Spring Boot 入门

---



## 1. Spring Boot 简介

Spring Boot来简化Spring应用开发，**约定大于配置**， 去繁从简，just run就能创建一个独立的，产品级别的应用

![](https://gitee.com/veal98/images/raw/master/img/20200528210455.png)

**背景**： 

J2EE笨重的开发、繁多的配置、低下的开发效率、 复杂的部署流程、第三方技术集成难度大

**解决**： 

“Spring全家桶” 时代

Spring Boot ——> J2EE一站式解决方案

Spring Cloud ——> 分布式整体解决方案

**优点**： 

- 快速创建独立运行的Spring项目以及与主流框架集成
- 使用嵌入式的Servlet容器，应用无需打成WAR包
- starters 自动依赖与版本控制
- 大量的自动配置，简化开发，也可修改默认值
- 无需配置XML，无代码生成，开箱即用
- 准生产环境的运行时应用监控
- 与云计算的天然集成

**总结**：

- 简化Spring应用开发的一个框架

- 整个Spring技术栈的一个大整合

- J2EE开发的一站式解决方案

## 2. 微服务

**微服务**：是一种架构风格（服务微化）

一个应用应该是一组小型服务；可以通过 HTTP 的方式进行互通；

> **单体应用**：ALL IN ONE
>
> ![](https://gitee.com/veal98/images/raw/master/img/20200528211512.png)



**微服务：每一个功能元素最终都是一个可独立替换和独立升级的软件单元：**

<img src="https://gitee.com/veal98/images/raw/master/img/20200528211629.png"  />



## 3. 环境准备

本博客所用环境：

– jdk1.8：Spring Boot 推荐 jdk1.7 及以上；java version "1.8.0_112"

– maven3.x：maven 3.3以上版本；Apache Maven 3.3.9

– SpringBoot 1.5.9.RELEASE：1.5.9；



## 4. HelloWorld

需求：浏览器发送 hello 请求，服务器接受请求并处理，响应Hello World 字符串；

### ① 创建一个  Maven 工程

此处只是一个小案例，所以我们不需要使用 Spring Initializr

🚨 创建完毕后，注意点击右下角的 `Enable Auto-Import`：我们每添加一个 pom 依赖，就会帮我们自动下载导入

![](https://gitee.com/veal98/images/raw/master/img/20200528215904.png)



### ② 导入spring boot相关的依赖

```xml
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>1.5.9.RELEASE</version>
    </parent>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
    </dependencies>
```

### ③ 编写一个主程序；启动Spring Boot应用

```java
/**
 *  @SpringBootApplication 来标注一个主程序类，说明这是一个Spring Boot应用
 */
@SpringBootApplication
public class HelloWorldMainApplication {

    public static void main(String[] args) {

        // Spring应用启动起来
        SpringApplication.run(HelloWorldMainApplication.class,args);
    }
}
```

### ④ 编写Controller

```java
@Controller
public class HelloController {

    @ResponseBody
    @RequestMapping("/hello")
    public String hello(){
        return "Hello World!";
    }
}

```

> @ ResponseBody 直接将返回值作为字符串返回给浏览器，而不是作为一个jsp界面
>
> @Controller + @ResponseBody = @**RestController**

### ⑤ 运行 main 函数测试

直接运行 Main 函数即可，[http://localhost:8080/hello](http://localhost:8080/hello)

### ⑥ 简化部署

无须在目标服务器安装 Tomcat 环境等等，直接运行该 jar 包

```xml
 <!-- 这个插件，可以将应用打包成一个可执行的jar包；-->
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
```

打包：

![](https://gitee.com/veal98/images/raw/master/img/20200528220845.png)

成功打包后该 jar 包会放在 target 文件夹下：

![](https://gitee.com/veal98/images/raw/master/img/20200528220933.png)

直接使用 `java -jar 包名` 的命令即可执行该 jar 包；

首先，打开命令行 cd 到该 jar 包所在文件夹，然后运行以下命令

```powershell
java -jar spring=boot-01-helloworld-1.0-SNAPSHOT.jar
```



## 5. Hello World探究

### ① POM文件

#### Ⅰ 父项目

我们项目中的父项目

```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>1.5.9.RELEASE</version>
</parent>
```

他的父项目是 👇

```xml
<parent>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-dependencies</artifactId>
  <version>1.5.9.RELEASE</version>
  <relativePath>../../spring-boot-dependencies</relativePath>
</parent>
```


他来真正管理Spring Boot应用里面的所有依赖版本；

是 Spring Boot 的版本仲裁中心；

以后我们导入依赖默认是不需要写版本；（没有在dependencies里面管理的依赖自然需要声明版本号）

#### Ⅱ 启动器

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
```

**spring-boot-starter**-`web`：

- spring-boot-starter：**spring-boot场景启动器**；帮我们导入了web模块正常运行所依赖的组件；

  ![](https://gitee.com/veal98/images/raw/master/img/20200528221854.png)



⭐ Spring Boot将所有的功能场景都抽取出来，做成一个个的starters（启动器），只需要在项目里面引入这些 starter 相关场景的所有依赖都会导入进来。要用什么功能就导入什么场景的启动器

![](https://gitee.com/veal98/images/raw/master/img/20200528222416.png)



### ② 主程序类/主入口类

```java
/**
 *  @SpringBootApplication 来标注一个主程序类，说明这是一个Spring Boot应用
 */
@SpringBootApplication
public class HelloWorldMainApplication {

    public static void main(String[] args) {

        // Spring应用启动起来
        SpringApplication.run(HelloWorldMainApplication.class,args);
    }
}

```

⭐ @**SpringBootApplication**（Spring Boot应用）：标注在某个类上说明这个类是 SpringBoot 的主配置类，SpringBoot 就应该运行这个类的 main 方法来启动 SpringBoot 应用；

该注解源码如下：

```java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan(excludeFilters = {
      @Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),
      @Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })
public @interface SpringBootApplication {
```

- @**SpringBootConfiguration**: Spring Boot 的配置类；

  标注在某个类上，表示这是一个 Spring Boot 的配置类；

  底层是 @**Configuration**: 配置类上来标注这个注解；

- @**EnableAutoConfiguration**：开启自动配置功能；

  以前我们需要配置的东西，Spring Boot帮我们自动配置；@**EnableAutoConfiguration**告诉 SpringBoot 开启自动配置功能；这样自动配置才能生效；

  该注解的源码如下：

    ```java
    @AutoConfigurationPackage
    @Import(EnableAutoConfigurationImportSelector.class)
    public @interface EnableAutoConfiguration {
    ```

  - ⭐ @**AutoConfigurationPackage**：自动配置包，**将主配置类（@SpringBootApplication标注的类）的所在包及下面所有子包里面的所有组件扫描到Spring容器**

- @**Import**(EnableAutoConfigurationImportSelector.class)：给容器中导入组件

  **EnableAutoConfigurationImportSelector**：导入哪些组件的选择器，将所有需要导入的组件以全类名的方式返回；这些组件就会被添加到容器中；

  该注解会给容器中导入非常多的自动配置类（xxxAutoConfiguration），就是给容器中导入这个场景需要的所有组件，并配置好这些组件；

  ![](https://gitee.com/veal98/images/raw/master/img/20200528223840.png)

<br>

有了自动配置类，免去了我们手动编写配置注入功能组件等的工作；

🚩 Spring Boot在启动的时候从类路径下的 `META-INF/spring.factories` 中获取 EnableAutoConfiguration 指定的值，将这些值作为自动配置类导入到容器中，自动配置类就生效，帮我们进行自动配置工作；以前我们需要自己配置的东西，自动配置类都帮我们配置好了；

![](https://gitee.com/veal98/images/raw/master/img/20200528224346.png)

![](https://gitee.com/veal98/images/raw/master/img/20200528224431.png)



> J2EE的整体整合解决方案和自动配置都在 `spring-boot-autoconfigure-1.5.9.RELEASE.jar`



## 6. ⭐ Spring Initializer 快速创建 Spring Boot 项目

IDE 都支持使用 Spring 的项目创建向导快速创建一个 Spring Boot 项目；

![](https://gitee.com/veal98/images/raw/master/img/20200529093821.png)

选择我们需要的模块，向导会联网自动创建Spring Boot项目；

![](https://gitee.com/veal98/images/raw/master/img/20200529093907.png)

默认生成的 Spring Boot 项目目录结构如下：

![](https://gitee.com/veal98/images/raw/master/img/20200529094814.png)

- resources 文件夹中目录结构
  - static：保存所有的静态资源； js css  images；
  - templates：保存所有的模板页面；（Spring Boot默认jar包使用嵌入式的Tomcat，<u>默认不支持JSP页面</u>），可以使用模板引擎（freemarker、thymeleaf）；
  - application.properties：Spring Boot应用的配置文件，可以修改一些默认设置；